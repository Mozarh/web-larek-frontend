# **Проектная работа "Веб-ларек"**

Интернет-магазин с товарами для веб-разработчиков — Web-ларёк. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

## **Используемый стек:**

* HTML, 
* SCSS, 
* TS, 
* Webpack

## **Структура проекта:**
* src/ — исходные файлы проекта
* src/components/ — папка с JS компонентами
* src/components/base/ — папка с базовым кодом

### **Важные файлы:**
* src/pages/index.html — HTML-файл главной страницы
* src/types/index.ts — файл с типами
* src/index.ts — точка входа приложения
* src/scss/styles.scss — корневой файл стилей
* src/utils/constants.ts — файл с константами
* src/utils/utils.ts — файл с утилитами

## **Установка и запуск**
Клонировать репозиторий

```
git clone https://github.com/Mozarh/web-larek-frontend.git
```

После клонирования проекта установить зависимости:

```
npm install 
```

Для запуска проекта в режиме разработки выполнить команду:

```
​npm run start 
```

Для сборки проекта в продакшен выполнить команду: 

```
​npm run build
```

## **Архитектура**

![<Блок-схема>](src/images/block.png)

Проект использует принцип MVC и компоненты с разделением обязанностей.
Основные части архитектуры:
* Модели (Models) — отвечают за бизнес-логику и данные приложения.
* Представления (Views) — отображают данные на экране и взаимодействуют с пользователем.
* Контроллеры (Controllers) — управляют логикой между моделями и представлениями.

## **Базовый код**

1. Класс Api - Этот класс управляет HTTP-запросами к серверу, выполняя запросы типа GET и POST. Он необходим для получения данных о товарах и отправки данных о заказах.

*Конструктор:*
```
constructor(baseUrl: string, options: RequestInit = {})
```
* baseUrl: string  - базовый URL для всех запросов к серверу.
* options: RequestInit = {} - глобальные опции для запросов.

*Методы:*
* handleResponse(response: Response): Promise<object>: обработчик ответа сервера. Преобразует ответ в объект JSON.
* get(uri: string) -  выполняет GET-запрос на сервер, передавая uri. Возвращает данные в формате JSON.
* post(uri: string, data: object, method: ApiPostMethods = 'POST') - выполняет POST-запрос, отправляя данные на сервер.

2. Класс EventEmitter- обеспечивает работу событий, позволяя компонентам системы взаимодействовать. Его функции: возможность установить и снять слушателей событий, вызвать слушателей при возникновении события.

*Конструктор:*
```
constructor()
```

*Методы:*
* on(event: string, callback: Function)- Установить обработчик на событие.
* off(event: string, callback: Function) — Снимает обработчик с указанного события.
* emit(event: string, data?: any) — Инициирует событие и передаёт данные в обработчик.
* onAll(callback: Function) — Слушает все события и вызывает указанный коллбек для каждого из них.
* offAll() — Убирает все обработчики событий.
* trigger(callback: Function) — Генерирует событие с переданным коллбеком.

3. Component - Базовый класс для всех представлений, реализующий логику работы с DOM. Управляет изменениями классов, установкой текстов и атрибутов, а также добавлением обработчиков событий.

*Конструктор:*
```
constructor(selector: string)
```
*Методы:*
* toggleClass(className: string, add: boolean): void - Добавляет или удаляет класс у элемента.
* setText(content: string): void - Устанавливает текстовое содержимое элемента.
* setAttribute(name: string, value: string): void - Устанавливает атрибут элемента.
* addEventListener(event: string, callback: EventListener): void - Добавляет обработчик события для элемента.
* removeEventListener(event: string, callback: EventListener): void - Удаляет обработчик события.
* hide(): void - Скрывает элемент, устанавливая его стиль display в none. 
* show(): void - Показывает элемент, устанавливая его стиль display в block.

4. ApiProduct - наследуется от класса Api и управляет запросами, связанными с товарами. С помощью этого класса осуществляется взаимодействие с сервером для получения списка товаров и оформления заказов.

*Конструктор:*
Наследует от Api, не требует дополнительных параметров.

*Методы:*
* getListProductCard(): Promise<Product[]> - Получает список товаров с сервера. Возвращает массив объектов Product.
* postOrder(order: Order): Promise<Response> - Отправляет данные о заказе на сервер. Возвращает статус ответа от сервера.

5. Класс Product - Представляет товар в интернет-магазине. Содержит всю необходимую информацию о товаре, такую как описание, цену и изображение. Этот класс используется для работы с API товаров и отображения их на странице.

*Конструктор:* 

Принимает параметры:
* id: уникальный идентификатор товара (строка).
* name: название товара (строка).
* description: описание товара (строка).
* price: цена товара (число).
* imageUrl: URL изображения товара (строка).

*Методы:*
* getDetails(): ProductDetails Возвращает подробную информацию о товаре
* addToCart(cart: Cart): void Добавляет товар в корзину.

6. Класс Cart - управляет корзиной покупок, где можно добавлять и удалять товары, а также вычислять общую стоимость корзины. Корзина будет хранить список товаров и их количество.

*Конструктор:* 
Принимает параметры:
* items: массив товаров в корзине (по умолчанию пустой массив). 

*Методы:*
* addItem(product:Product): добавляет товар в корзину.
* removeItem(productId: string): void: Убирает товар из корзины по id.
* getTotalAmount(): number Рассчитывает и возвращает общую стоимость товаров в корзине.

7. Класс Order - управляет заказом и отправкой данных на сервер. Он включает информацию о заказе, покупателе и списке товаров в корзине.

*Конструктор:* 
Принимает параметры:
* cart: объект корзины, содержащий товары. 
* customerInfo: объект с данными покупателя (адрес, email, телефон).

*Методы:*
* createOrder(cart: Cart, customerInfo: CustomerInfo): Создаёт новый заказ.
* submitOrder(order: Order): Отправляет заказ на сервер.
* getOrderStatus(orderId: string): Получает статус заказа.

## **Взаимодействие классов**

1. Добавление товара в корзину.
* Когда пользователь нажимает на кнопку "Купить", вызывается метод addItem() класса Cart, который добавляет товар в корзину.
2. Оформление заказа.
* После того как товары добавлены в корзину, пользователь может перейти к оформлению заказа. В этот момент создаётся объект Order, который включает информацию о покупателе и товарах из корзины.
3. Взаимодействие с сервером.
* Для получения списка товаров с сервера используется метод getListProductCard() класса ApiProduct, а для отправки заказа на сервер — метод postOrder() этого же класса.
4. Обработка событий.
* Взаимодействие между компонентами осуществляется через систему событий, реализованную в классе EventEmitter. Это позволяет обновлять состояние корзины, отображение товаров и оформление заказа без жесткой привязки компонентов друг к другу.